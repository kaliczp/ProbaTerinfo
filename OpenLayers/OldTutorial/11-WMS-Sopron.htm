<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="ol.css" type="text/css"> <!-- styles for OpenLayers -->
		<script src="ol.js" type="text/javascript"></script> <!-- Loading OpenLayers Library -->
		<title>OpenLayers 3 example</title>
		<style>
			iframe 
			{
				width: 100%;
				height: 250px;
				border: none;
			}
		</style>
	</head>
	<body>
		<div id="map" style="width: 100%; height: 500px"></div> <!-- Map Render target -->
		<div id="info" style="width: 100%; height: 80px"></div> <!-- Info Display -->
		<script>

			var bounds = [672617, 249808, 676434, 251027]; // boundary box, in Projected Coord. System

			var projection = new ol.proj.Projection( // Hungarian Unified Projection
			{
				code: 'EPSG:23700', // Projection Identifier
				units: 'm', // metric units
				axisOrientation: 'neu' // north east up
			});
			
			var wmsSource = new ol.source.ImageWMS( // single image WMS
			{
				url: 'http://ims.nyme.hu:8080/geoserver/exp8test1/wms', // WMS source, UWH
				params: 
				{
					'FORMAT': 'image/png', // png output
					'VERSION': '1.1.1', // Version of the WMS service
					'LAYERS': 'exp8test1:godollo' // layer or layergroup selection
				}
			});
		
			var map=new ol.Map( // creating a new OpenLayers Map object
			{
				target: 'map', // set render target
				layers: // enumerating layers: Image, Tile or Vector
				[
					new ol.layer.Image( // Image layer
					{
						source: wmsSource // set source
					})
				],		
				view: new ol.View( // new View
				{
					projection: projection, // projection
				}),
			});
			
			map.getView().fit(bounds, map.getSize()); // zoom to boundary box
			
			// WMS request: getFeatureInfo
			map.on('singleclick', function(evt) // define an event listener for click
			{
				document.getElementById('info').innerHTML = ''; // clear the info object
				var viewResolution = map.getView().getResolution(); // query the resolution
				var url = wmsSource.getGetFeatureInfoUrl(evt.coordinate, viewResolution, // get feature info, coordinates and resolution
					projection, {'INFO_FORMAT': 'text/html', 'FEATURE_COUNT': 50}); // projection and parameters
				if(url) // if we have results
				{
					document.getElementById('info').innerHTML = // display it
						'<iframe seamless src="' + url + '"></iframe>'; // in a frame
				}
			});

			
		</script>
	</body>
</html>